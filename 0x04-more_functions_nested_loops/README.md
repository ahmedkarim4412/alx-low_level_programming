more function and nested loop is mandatory
